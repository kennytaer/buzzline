import{r as n,j as e}from"./index-C-5hEMXZ.js";import{g as v}from"./utils-z-rVVjtK.js";import{u as j,a as y,F as N}from"./components-CcwgdvBG.js";function D(){const{availableFields:c,totalContacts:m}=j(),t=y(),[o,u]=n.useState(""),[x,b]=n.useState(""),[l,i]=n.useState([]),[f,w]=n.useState(null),h=[{value:"equals",label:"Equals"},{value:"not_equals",label:"Does not equal"},{value:"contains",label:"Contains"},{value:"not_contains",label:"Does not contain"},{value:"starts_with",label:"Starts with"},{value:"ends_with",label:"Ends with"},{value:"greater_than",label:"Greater than"},{value:"less_than",label:"Less than"},{value:"greater_equal",label:"Greater than or equal"},{value:"less_equal",label:"Less than or equal"},{value:"is_empty",label:"Is empty"},{value:"is_not_empty",label:"Is not empty"}],g=()=>{var r;const s={id:v(),field:((r=c[0])==null?void 0:r.key)||"",operator:"equals",value:"",logic:l.length>0?"AND":void 0};i([...l,s])},d=(s,r)=>{i(l.map(a=>a.id===s?{...a,...r}:a))},p=s=>{i(l.filter(r=>r.id!==s))};return t&&"success"in t&&t.success?e.jsx("div",{className:"px-4 py-6 sm:px-0",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("svg",{className:"h-5 w-5 text-green-400 mt-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-medium text-green-800",children:"Segment Created!"}),e.jsx("div",{className:"mt-2 text-sm text-green-700",children:e.jsxs("p",{children:['Successfully created segment "',o,'" with ',t&&"matchedContacts"in t?t.matchedContacts:0," matching contacts."]})}),e.jsx("div",{className:"mt-4",children:e.jsx("a",{href:`/dashboard/contacts/segments/${t&&"segmentId"in t?t.segmentId:""}`,className:"text-green-800 hover:text-green-900 font-medium",children:"View segment â†’"})})]})]})})})}):e.jsx("div",{className:"px-4 py-6 sm:px-0",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"md:flex md:items-center md:justify-between mb-6",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create New Segment"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Create a dynamic segment by filtering your ",m," contacts based on their properties."]})]})}),t&&"error"in t&&e.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:t.error})}),e.jsxs(N,{method:"post",className:"space-y-6",children:[e.jsx("input",{type:"hidden",name:"filters",value:JSON.stringify(l)}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Segment Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Segment Name *"}),e.jsx("input",{type:"text",name:"segmentName",value:o,onChange:s=>u(s.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2",placeholder:"e.g., High-Value Customers, Newsletter Subscribers",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{name:"segmentDescription",value:x,onChange:s=>b(s.target.value),rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2",placeholder:"Describe this segment..."})]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Filters"}),e.jsxs("button",{type:"button",onClick:g,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[e.jsx("svg",{className:"-ml-0.5 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Filter"]})]}),l.length===0?e.jsx("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No filters added yet. Add a filter to start building your segment."})}):e.jsx("div",{className:"space-y-4",children:l.map((s,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[r>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logic"}),e.jsxs("select",{value:s.logic||"AND",onChange:a=>d(s.id,{logic:a.target.value}),className:"block w-32 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"AND",children:"AND"}),e.jsx("option",{value:"OR",children:"OR"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Field"}),e.jsx("select",{value:s.field,onChange:a=>d(s.id,{field:a.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2",children:c.map(a=>e.jsx("option",{value:a.key,children:a.label},a.key))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operator"}),e.jsx("select",{value:s.operator,onChange:a=>d(s.id,{operator:a.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2",children:h.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Value"}),s.field==="optedOut"?e.jsxs("select",{value:s.value,onChange:a=>d(s.id,{value:a.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2",children:[e.jsx("option",{value:"false",children:"Active"}),e.jsx("option",{value:"true",children:"Opted Out"})]}):["is_empty","is_not_empty"].includes(s.operator)?e.jsx("input",{type:"text",value:"(no value needed)",disabled:!0,className:"block w-full rounded-md border-gray-300 bg-gray-100 text-gray-500"}):e.jsx("input",{type:"text",value:s.value,onChange:a=>d(s.id,{value:a.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2",placeholder:"Enter value..."})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"button",onClick:()=>p(s.id),className:"inline-flex items-center px-3 py-2 border border-red-300 text-sm leading-4 font-medium rounded-md text-red-700 bg-white hover:bg-red-50",children:"Remove"})})]})]},s.id))})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("a",{href:"/dashboard/contacts",className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!o||l.length===0,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Create Segment"})]})]})]})})}export{D as default};
